---
title: "Even Fibonacci Numbers"
subtitle: "[Euler Problem 2](https://projecteuler.net/problem=2)"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

> Each new term in the Fibonacci sequence is generated by adding the previous two terms. By starting with 1 and 2, the first 10 terms will be: 
$$ 1, 2, 3, 5, 8, 13, 21, 34, 55, 89, ... $$ 
> By considering the terms in the Fibonacci sequence whose values do not exceed four million, find the sum of the even-valued terms.

### Solution

We'll try using the nice approach with a memo to avoid stack depth problems. 

First we set up the storage, create the Fibonacci function, and prepopulate the memo vector:

```{r}
# Set up memo to avoid stack problems
fibMemo <- 1:1000 * NA
fibMemo[c(1,2)] <- c(1,2)

# Create Fibonacci function
fib <- function(n)
{
    if (is.na(fibMemo[n])) fibMemo[n] <<- fib(n-1)+fib(n-2)
    return(fibMemo[n])
}

# Prepopulate the memo past 4MM
fib(50)
```

Clearly that is larger than four million, so we're good to use the `fibMemo` vector now. With that out of the way, we can sum up all the elements of the sequence less than four million:

```{r}
# Filter to those less than 4MM, which are populated, which are even, then sum:
answer <- sum(fibMemo[(fibMemo < 4*10^6) & (!is.na(fibMemo)) & (fibMemo %% 2 == 0)])

answer

```
The resulting value of `r formatC(answer, format="f", big.mark=",", digits=0)` is correct.
